import requests 
import signal
import string
import sys

from bs4 import BeautifulSoup

# ignore warnings BeautifulSoup
import warnings
warnings.filterwarnings("ignore", category=UserWarning, module='bs4')

# ctrl + c
def signal_handler(signum, frame):
    sys.exit('\n[!] Interruption.')

signal.signal(signal.SIGINT, signal_handler)

# variables
target = 'http://10.10.11.170:8080/search'
characters = string.punctuation

# post request
def make_request():
    
    try:    
        session = requests.Session()
        headers = {'Content-Type' : 'application/x-www-form-urlencoded'}
        for c in characters:
            post_data = f'name={c}'
            response = session.post(target, headers=headers, data=post_data)
            bresponse = BeautifulSoup(response.text, 'lxml')
            results = bresponse.find(class_='searched')
            if response.status_code == 200:
                if not 'Error occured: banned characters' in str(results):
                    print(f'{c} : Valid')
                else: print(f'{c} : Invalid')
            elif response.status_code == 400:
                print(f'{c} : Bad request')
            elif response.status_code == 500:
                print(f'{c} : Internal Server Error')
    except Exception as e:
        sys.exit(f'\n[x] {e}')

if __name__ == '__main__':
    make_request()
